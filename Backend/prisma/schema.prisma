generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// --- ENUMS ---

enum BookingStatus {
  PENDING
  CONFIRMED
  CANCELLED
  COMPLETED
}

enum PaymentStatus {
  PENDING   // added this
  UNPAID
  PAID
  REFUNDED
  FAILED
}

// --- MODELS ---

model User {
  id         String  @id @default(uuid())
  fullName   String
  email      String  @unique
  password   String
  phone      String?
  isAdmin    Boolean @default(false)
  isVerified Boolean @default(false)

  bookings Booking[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model ServiceCategory {
  id   String @id @default(uuid())
  name String @unique
  slug String @unique

  services Service[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Service {
  id          String  @id @default(uuid())
  name        String
  description String?
  type        String?
  duration    Int
  price       Float
  image       String?

  categoryId String?
  category   ServiceCategory? @relation(fields: [categoryId], references: [id])

  bookings Booking[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Booking {
  id String @id @default(uuid())

  userId String
  user   User   @relation(fields: [userId], references: [id])

  serviceId String
  service   Service @relation(fields: [serviceId], references: [id])

  startTime DateTime
  endTime   DateTime

  status          BookingStatus @default(PENDING)
  paymentStatus   PaymentStatus @default(PENDING)
  stripePaymentId String?

  clientNotes String?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@unique([serviceId, startTime])
  @@index([userId])
  @@index([serviceId])
}
